DEFAULT: &default
  XNAT_CREDENTIALS_FILE: $HOME/.xnat_credentials
  RUNTIME_FILES_DIR: $HOME/hcp-pipelines/runtime
  EXPECTED_FILES_LIST: $RUNTIME_FILES_DIR/expected_files/$PIPELINE_NAME.txt
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/ls_struc_preproc/xnat_pbs_jobs_control_CCF_HCA
  REQUESTED_XNAT_SERVER: intradb
  SINGULARITY_CONTAINER_VERSION: singularity-3.5.2
  SINGULARITY_BIND_PATH: /NRG-data/NRG/intradb/build,/export/HCP/qunex-hcp
  SINGULARITY_QUNEXPARAMETER_PATH: $RUNTIME_FILES_DIR/parameter_files/SpecFiles_v4
  SINGULARITY_QUNEXRUN_PATH: /opt/xnat_pbs_jobs_control/run_qunex.sh
  #SINGULARITY_CONTAINER_PATH: /export/HCP/qunex-hcp/production_containers/qunex_0.61.17_FSL603.sif
  SINGULARITY_CONTAINER_PATH: /export/HCP/qunex-hcp/production_containers/qunex_0.62.3_FSL603.sif
  SINGULARITY_CONTAINER_XNAT_PATH: /scratch/Mobalt/pipelines.sif
  SINGULARITY_CONTAINER_PIPELINES_PATH: /scratch/Mobalt/pipelines.sif
  GRADIENT_COEFFICIENT_PATH: $RUNTIME_FILES_DIR/gradient_coefficient_files
  SEVEN_MM_TEMPLATE_PROJECTS: ('HCP_500', 'HCP_900', 'HCP_1200')
  CONNECTOME_SKYRA_SCANNER_PROJECTS: ('HCP_500', 'HCP_900', 'HCP_1200')
  PRISMA_3T_PROJECTS: ('CCF_BWH_STG', 'CCF_MDD_STG', 'CCF_HCA_STG', 'CCF_HCD_STG')

  XNAT_PBS_JOBS_LOG_DIR: $HOME/XNAT_LOGS
  XNAT_PBS_JOBS: /pipeline_tools/xnat_pbs_jobs
  XNAT_PBS_JOBS_ARCHIVE_ROOT: /NRG-data/NRG/intradb/archive
  XNAT_PBS_JOBS_XNAT_SERVER: hcpi-shadow10.nrg.wustl.edu
  XNAT_PBS_JOBS_PUT_SERVER_LIST: hcpi-shadow11.nrg.wustl.edu hcpi-shadow12.nrg.wustl.edu hcpi-shadow13.nrg.wustl.edu hcpi-shadow14.nrg.wustl.edu hcpi-shadow15.nrg.wustl.edu hcpi-shadow16.nrg.wustl.edu hcpi-shadow17.nrg.wustl.edu

  HCP_LIB_DIR: /pipeline_tools/hcp-pipelines/lib
  XNAT_PBS_JOBS_PIPELINE_ENGINE: /pipeline_tools/xnat_pbs_jobs/WorkingDirPut
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build
  XNAT_UTILS_HOME: /export/HCP/xnat_utilities

  FREESURFER_LICENSE_PATH: $HOME/freesurfer/license
  HCP_RUN_UTILS: /pipeline_tools/HCPpipelinesRunUtils
  CLEAN_OUTPUT_FIRST: false
  WALLTIME_LIMIT_HOURS: 52
  MEM_LIMIT_GBS: 8
  BRAIN_SIZE: 150

  USE_SCRATCH_FOR_PROCESSING: False
  AUTOLAUNCH_AT_END: False
  PROCESSING_STAGE: CHECK_DATA

#defaults from scripts.yaml:
  GET_DATA_BINDPATH: $XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH,$XNAT_PBS_JOBS_BUILD_DIR
  CHECK_DATA_BINDPATH: $XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH
  MARK_RUNNING_STATUS_BINDPATH: $XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH
  PUT_DATA_BINDPATH: $XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH
  PROCESS_PBS_HASWELL: True
  PROCESS_PBS_K20X: False
  PROCESS_PBS_GPU: 0
  PROCESS_NVIDIA: False
  PROCESS_DATA_BINDPATH: "${GRADIENT_COEFFICIENT_PATH}:/export/HCP/gradient_coefficient_files,$XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH,$XNAT_PBS_JOBS_CONTROL:/opt/xnat_pbs_jobs_control"

#common_vars:
  SINGULARITY_VERSION: $SINGULARITY_CONTAINER_VERSION
  SCRATCH_SPACE: /scratch/$USER/buildspace/structural/$SUBJECT_PROJECT
  BUILD_SPACE: ${XNAT_PBS_JOBS_BUILD_DIR}/${SUBJECT_PROJECT}
  DIR_PREFIX: ${PIPELINE_NAME}.${SUBJECT_SESSION}_${SUBJECT_EXTRA}.${TIMESTAMP}
  WORKING_DIR_BASENAME: ${DIR_PREFIX}.XNAT_PROCESS_DATA
  WORKING_DIR: ${BUILD_SPACE}/$WORKING_DIR_BASENAME
  CHECK_DATA_DIR: ${BUILD_SPACE}/${DIR_PREFIX}.XNAT_CHECK_DATA
  MARK_COMPLETION_DIR: ${BUILD_SPACE}/${DIR_PREFIX}.XNAT_MARK_COMPLETE_RUNNING_STATUS
  SCRIPTNAME: ${SUBJECT_SESSION}_${SUBJECT_EXTRA}.${PIPELINE_NAME}
  RUNPATH: ${XNAT_PBS_JOBS}/${PIPELINE_NAME}/${PIPELINE_NAME}
  GET_DATA_RUNPATH: ${RUNPATH}.XNAT_GET
  CHECK_DATA_RUNPATH: ${RUNPATH}.XNAT_CHECK
  MARK_RUNNING_STATUS_RUNPATH: ${RUNPATH}.XNAT_MARK_RUNNING_STATUS
  STARTTIME_FILE_NAME: ${WORKING_DIR}/${SUBJECT_SESSION}/ProcessingInfo/${SUBJECT_SESSION}_${SUBJECT_EXTRA}.${PIPELINE_NAME}.starttime
  XNAT_PBS_SETUP_SCRIPT_PATH: ${XNAT_PBS_JOBS_CONTROL}/xnat_pbs_setup


functional: &functional
  <<: *default
  PROCESS_DATA_BINDPATH: "${GRADIENT_COEFFICIENT_PATH}:/export/HCP/gradient_coefficient_files,$XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH"
  GET_PHASE: func_preproc_prereqs
  OUTPUT_RESOURCE_NAME: ${SUBJECT_EXTRA}_preproc
  WALLTIME_LIMIT_HOURS: 24
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER
  XNAT_PBS_JOBS_PUT_SERVER_LIST: hcpi-shadow11.nrg.wustl.edu hcpi-shadow12.nrg.wustl.edu hcpi-shadow13.nrg.wustl.edu hcpi-shadow14.nrg.wustl.edu hcpi-shadow15.nrg.wustl.edu hcpi-shadow16.nrg.wustl.edu hcpi-shadow17.nrg.wustl.edu hcpi-shadow18.nrg.wustl.edu hcpi-shadow19.nrg.wustl.edu
  SINGULARITY_BIND_PATH: /NRG-data/NRG/intradb/build_ssd,/export/HCP/qunex-hcp
  SINGULARITY_QUNEXRUN_PATH: /export/HCP/qunex-hcp/run_scripts/run_qunex.sh
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd
  PROCESSING_STAGE: CHECK_DATA
  AUTOLAUNCH_AT_END: True

functional_preprocess_CCF_BWH:
  <<: *functional
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/pipeline_tools_production_n_func/xnat_pbs_jobs_control_CCF_BWH

functional_preprocess_CCF_HCA:
  <<: *functional
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/pipeline_tools_production_n_func/xnat_pbs_jobs_control_CCF_HCA

functional_preprocess_CCF_HCD:
  <<: *functional
  WALLTIME_LIMIT_HOURS: 48
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/pipeline_tools_production_n_func/xnat_pbs_jobs_control_CCF_HCD

structural_process: &structural_process
  PROCESS_DATA_BINDPATH: "${GRADIENT_COEFFICIENT_PATH}:/export/HCP/gradient_coefficient_files,$XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH,$BUILD_SPACE,$SCRATCH_SPACE"

hand_edit: &hand_edit
  <<: *default
  <<: *structural_process
  GET_PHASE: struct_preproc_hand_edit_prereqs
  MEM_LIMIT_GBS: 64
  OUTPUT_RESOURCE_NAME: Structural_preproc_handedit
  XNAT_PBS_JOBS_SHADOWS_SUBDIR:
  XNAT_PBS_JOBS_PUT_SERVER_LIST: hcpi-shadow11.nrg.wustl.edu hcpi-shadow12.nrg.wustl.edu hcpi-shadow13.nrg.wustl.edu hcpi-shadow14.nrg.wustl.edu hcpi-shadow15.nrg.wustl.edu hcpi-shadow16.nrg.wustl.edu hcpi-shadow17.nrg.wustl.edu hcpi-shadow18.nrg.wustl.edu hcpi-shadow19.nrg.wustl.edu
  HAND_EDIT_PROCESSING_DIR: /scratch/$USER/hand_edit_buildspace
  SINGULARITY_QUNEXRUN_PATH: $HOME/processing/hand_edit_test/run_qunex_test.sh

hand_edit_CCF_HCA:
  <<: *hand_edit
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_OLDBUILD_DIR/$USER
  SINGULARITY_BIND_PATH: "/NRG-data/NRG/intradb/build,/export/HCP/qunex-hcp,/scratch/$USER/hand_edit_buildspace,$HOME/pipeline_tools/HCPpipelinesXnatPbsJobs:/pipeline_tools/xnat_pbs_jobs,$HOME/pipeline_tools/HCPpipelinesRunUtils:/pipeline_tools/xnat_pbs_jobs"
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/hand_edit_test/xnat_pbs_jobs_control_CCF_HCA
  WALLTIME_LIMIT_HOURS: 120

hand_edit_CCF_HCD:
  <<: *hand_edit
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER
  SINGULARITY_BIND_PATH: /NRG-data/NRG/intradb/build_ssd,/export/HCP/qunex-hcp,/scratch/$USER/hand_edit_buildspace
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/hand_edit_test/xnat_pbs_jobs_control_CCF_HCD
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd

msmall: &msmall
  <<: *default
  SCRATCH_TMP_DIR: /scratch/$USER/singularity/tmp/$SUBJECT_SESSION
  PROCESS_DATA_BINDPATH: "${GRADIENT_COEFFICIENT_PATH}:/export/HCP/gradient_coefficient_files,$XNAT_PBS_JOBS_ARCHIVE_ROOT,$SINGULARITY_BIND_PATH,$XNAT_PBS_JOBS_CONTROL:/opt/xnat_pbs_jobs_control,$SCRATCH_TMP_DIR:/tmp"
  GET_PHASE: msmall_prereqs
  WALLTIME_LIMIT_HOURS: 20
  OUTPUT_RESOURCE_NAME: MsmAll_proc
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER/msmall_Q2_2020_runs
  XNAT_PBS_JOBS_SHADOWS_SUBDIR: msmall_Q2_2020_runs
  XNAT_PBS_JOBS_PUT_SERVER_LIST: hcpi-shadow11.nrg.wustl.edu hcpi-shadow12.nrg.wustl.edu hcpi-shadow13.nrg.wustl.edu hcpi-shadow14.nrg.wustl.edu hcpi-shadow15.nrg.wustl.edu hcpi-shadow16.nrg.wustl.edu hcpi-shadow17.nrg.wustl.edu hcpi-shadow18.nrg.wustl.edu hcpi-shadow19.nrg.wustl.edu
  SINGULARITY_BIND_PATH: "/NRG-data/NRG/intradb/build_ssd,/export/HCP/qunex-hcp,$HOME/pipeline_tools/HCPpipelinesXnatPbsJobs:/pipeline_tools/xnat_pbs_jobs"
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd
  PROCESSING_STAGE: CHECK_DATA
  AUTOLAUNCH_AT_END: True

msmall_process_CCF_HCA:
  <<: *msmall
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/msmall_Q2_2020_runs/xnat_pbs_jobs_control_CCF_HCA

msmall_process_CCF_HCD:
  <<: *msmall
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/msmall_Q2_2020_runs/xnat_pbs_jobs_control_CCF_HCD

multirunicafix: &multirunicafix
  <<: *default
  PROCESS_PBS_HASWELL: False
  GET_PHASE: multirunicafix_prereqs
  WALLTIME_LIMIT_HOURS: 48
  MEM_LIMIT_GBS: 48
  OUTPUT_RESOURCE_NAME: MultiRunIcaFix_proc
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER/icafix_Q2_2020_runs
  XNAT_PBS_JOBS_SHADOWS_SUBDIR: icafix_Q2_2020_runs
  XNAT_PBS_JOBS_PUT_SERVER_LIST: hcpi-shadow11.nrg.wustl.edu hcpi-shadow12.nrg.wustl.edu hcpi-shadow13.nrg.wustl.edu hcpi-shadow14.nrg.wustl.edu hcpi-shadow15.nrg.wustl.edu hcpi-shadow16.nrg.wustl.edu hcpi-shadow17.nrg.wustl.edu hcpi-shadow18.nrg.wustl.edu hcpi-shadow19.nrg.wustl.edu
  SINGULARITY_BIND_PATH: /NRG-data/NRG/intradb/build_ssd,/export/HCP/qunex-hcp
  SINGULARITY_QUNEXRUN_PATH: /export/HCP/qunex-hcp/run_scripts/run_qunex.sh
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd
  PROCESSING_STAGE: CHECK_DATA
  AUTOLAUNCH_AT_END: True

multirunicafix_process_CCF_HCA:
  <<: *multirunicafix
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/icafix_Q2_2020_runs/xnat_pbs_jobs_control_CCF_HCA


multirunicafix_process_CCF_HCD:
  <<: *multirunicafix
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/icafix_Q2_2020_runs/xnat_pbs_jobs_control_CCF_HCD

structural_preprocess: &structural_preprocess
  <<: *default
  <<: *structural_process
  GET_PHASE: struct_preproc_prereqs
  USE_PRESCAN_NORMALIZED: False
  OUTPUT_RESOURCE_NAME: Structural_preproc
  SINGULARITY_BIND_PATH: "$XNAT_PBS_JOBS_CONTROL:/opt/xnat_pbs_jobs_control,/export/HCP/qunex-hcp,/NRG-data/NRG/intradb/build"
  SINGULARITY_QUNEXPARAMETER_PATH: $RUNTIME_FILES_DIR/parameter_files/SpecFiles_v3
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_OLDBUILD_DIR/$USER/ls_struc_preproc
  XNAT_PBS_JOBS_SHADOWS_SUBDIR: ls_struc_preproc
  USE_SCRATCH_FOR_PROCESSING: True
  PROCESSING_STAGE: CHECK_DATA
  AUTOLAUNCH_AT_END: True

structural_preprocess_CCF_BWH:
  <<: *structural_preprocess
  SINGULARITY_BIND_PATH: "$XNAT_PBS_JOBS_CONTROL:/opt/xnat_pbs_jobs_control,/export/HCP/qunex-hcp,/NRG-data/NRG/intradb/build_ssd,/home/$USER"
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER/bwh_struc_preproc
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/bwh_struc_preproc/xnat_pbs_jobs_control_CCF_BWH
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd
  XNAT_PBS_JOBS_SHADOWS_SUBDIR: bwh_struc_preproc

structural_preprocess_CCF_HCA:
  <<: *structural_preprocess
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/ls_struc_preproc/xnat_pbs_jobs_control_CCF_HCA

structural_preprocess_CCF_HCD:
  <<: *structural_preprocess
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/ls_struc_preproc/xnat_pbs_jobs_control_CCF_HCD

structural_preprocess_CCF_MDD:
  <<: *structural_preprocess
  SINGULARITY_BIND_PATH: "$XNAT_PBS_JOBS_CONTROL:/opt/xnat_pbs_jobs_control,/export/HCP/qunex-hcp,/NRG-data/NRG/intradb/build_ssd,/home/$USER"
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER/mdd_struc_preproc
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/mdd_struc_preproc/xnat_pbs_jobs_control_CCF_MDD
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd
  XNAT_PBS_JOBS_SHADOWS_SUBDIR: mdd_struc_preproc

diffusion_preprocess: &diffusion_preprocess
  <<: *default
  PROCESS_PBS_HASWELL: False
  PROCESS_PBS_K20X: True
  PROCESS_PBS_GPU: 1
  PROCESS_NVIDIA: True
  GET_PHASE: diff_preproc_prereqs
  OUTPUT_RESOURCE_NAME: Diffusion_preproc
  SINGULARITY_BIND_PATH: "$XNAT_PBS_JOBS_CONTROL:/opt/xnat_pbs_jobs_control,/export/HCP/qunex-hcp,/NRG-data/NRG/intradb/build_ssd"
  SINGULARITY_QUNEXPARAMETER_PATH: $RUNTIME_FILES_DIR/parameter_files/SpecFiles_v3
  SINGULARITY_CONTAINER_PATH: /export/HCP/qunex-hcp/production_containers/qunex_0.62.3a.sif
  XNAT_PBS_JOBS_BUILD_DIR: $HOME/XNAT_BUILD_DIR/$USER/diffusion_preproc
  XNAT_PBS_JOBS_SHADOWS_ROOT: /data/intradb/build_ssd
  XNAT_PBS_JOBS_SHADOWS_SUBDIR: diffusion_preproc
  USE_SCRATCH_FOR_PROCESSING: False
  WALLTIME_LIMIT_HOURS: 72
  MEM_LIMIT_GBS: 32
  PROCESSING_STAGE: CHECK_DATA
  AUTOLAUNCH_AT_END: True

diffusion_preprocess_CCF_HCA:
  <<: *diffusion_preprocess
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/diffusion_Q3_2020_runs/xnat_pbs_jobs_control_CCF_HCA

diffusion_preprocess_CCF_HCD:
  <<: *diffusion_preprocess
  XNAT_PBS_JOBS_CONTROL: $HOME/processing/diffusion_Q3_2020_runs/xnat_pbs_jobs_control_CCF_HCA

